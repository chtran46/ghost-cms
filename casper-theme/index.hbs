{{!< default}}
{{!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template --}}

{{#match @custom.publication_cover_style "!=" "None"}}
    <div class="site-header-content{{#match @custom.publication_cover_style "Large"}} large{{/match}}">
        {{#if @site.cover_image}}
            {{!-- This is a responsive image, it loads different sizes depending on device
            https://medium.freecodecamp.org/a-guide-to-responsive-images-with-ready-to-use-templates-c400bd65c433 --}}
			{{!-- Comment out original to replace with Cloudinary
            <img class="site-header-cover"
                srcset="{{img_url @site.cover_image size="s"}} 300w,
                        {{img_url @site.cover_image size="m"}} 600w,
                        {{img_url @site.cover_image size="l"}} 1000w,
                        {{img_url @site.cover_image size="xl"}} 2000w"
                sizes="100vw"
                src="{{img_url @site.cover_image size="xl"}}"
                alt=""
            />
			--}}

			<img class="site-header-cover" id='cover'/>
			<script type="text/javascript">		
				function getPosition(string, subString, index) {
				  return string.split(subString, index).join(subString).length;
				}
				let imgurl="{{img_url @site.cover_image}}";
				let cloudinary_public_id = imgurl.slice(getPosition(imgurl, '/', 8));
				let cloudinary_baseurl = "https://res.cloudinary.com/chtran/image/upload";
				document.getElementById('cover').srcset =
					cloudinary_baseurl + "/w_300" + cloudinary_public_id + " 300w," +
					cloudinary_baseurl + "/w_600" + cloudinary_public_id + " 600w," +
					cloudinary_baseurl + "/w_1000" + cloudinary_public_id + " 1000w," +
					cloudinary_baseurl + "/w_2000" + cloudinary_public_id + " 2000w"
				document.getElementById('cover').src = cloudinary_baseurl + "/w_2000" + cloudinary_public_id;
				document.getElementById('cover').sizes = "100vw";
				document.getElementById('cover').alt="cover image";
			</script>

			
        {{/if}}
        <h1 class="site-title">
            {{#if @site.logo}}
                <img class="site-logo" src="{{img_url @site.logo size="m"}}" alt="{{@site.title}}" />
            {{else}}
                {{@site.title}}
            {{/if}}
        </h1>
        <p>{{@site.description}}</p>
    </div>
{{/match}}

{{!-- The main content area --}}
<main id="site-main" class="site-main outer">
    <div class="inner posts">

        <div class="post-feed{{#match @custom.feed_layout "List"}} list{{/match}}">
            {{#foreach posts}}

                {{!-- The tag below includes the markup for each post - partials/post-card.hbs --}}
                {{> "post-card"}}

            {{/foreach}}
        </div>

    </div>

	<div>
		<form autocomplete="off">
		{{!--
			<input id="search-field" />
			<input class="gh-head-button" type="submit" value="search">
		--}}
			<center>
				<div class="search-box">
					<button class="btn-search"><i class="fas fa-search"></i></button>
					<input id="search-field" type="text" class="input-search" placeholder="Type to Search...">
				</div>	
			</center>
		</form>
		<section id="results"></section>
	</div>	
</main>

